<project name="contrib-autodoc" default="all">

  <description>
    Generate documentation for the current version of clojure-contrib and post it to 
    the google code wiki for the project.
  </description>

	<property name="clojure-jar" location="../clojure/clojure.jar"/>
	<property name="miglayout-jar" location="${user.home}/.clojure/miglayout-3.7.jar"/>
	<property name="clojure-json-jar" location="${user.home}/.clojure/clojure-json.jar"/>
  <property name="force" value="false"/>
  <property name="output-dir" value="../wiki-work-area/wiki-src/"/>
  <property name="static-dir" value="static/"/>
  <target name="copy-statics"
          description="Copy all of the static files (css, etc.) from here to the target directory">
    <copy todir="${output-dir}/${static-dir}">
      <fileset dir="${static-dir}"/>
    </copy>
  </target>
	<target name="build-contrib" 
					description="Update and, if necessary, build the contrib files">
		<java classname="clojure.main" classpath="${clojure-jar}:${clojure-json-jar}:." 
					fork="true" failonerror="true">
      <arg value="-e"/>
      <arg value="(use 'gen-contrib-docs) (main :build-contrib  ${force})"/>
		</java>
	</target>

	<target name="build-wiki" 
					description="Generate and commit wiki files">
		<java classname="clojure.main"
          classpath="${clojure-jar}:${miglayout-jar}:${clojure-json-jar}:." 
					fork="true" failonerror="true">
      <arg value="-e"/>
      <arg value="(use 'gen-contrib-docs) (main :build-wiki ${force})"/>
		</java>
	</target>

<target name="all" depends="build-contrib, build-wiki"
        description="Update the wiki based on the latest source, if appropriate"/>

</project>
